<!DOCTYPE html>
<html>
<head>
    <!-- https://github.com/google/code-prettify -->
    <meta charset="UTF-8">
    <title>JS Code Formatter</title>
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono" rel="stylesheet">

    <link href="google-code-prettify/prettify.css" type="text/css" rel="stylesheet" />
    <script src="google-code-prettify/run_prettify.js"></script>
    <script src="google-code-prettify/prettify.js"></script>

    <link href="style.css" type="text/css" rel="stylesheet" />
</head>

<body>
    <a href="http://codebeautify.org/javascript-tools" target="_blank" title="(Will be open in new window.)">JavaScript Tools</a>
    <span class="on">on <a href="http://codebeautify.org" target="_blank" title="(Will be open in new window.)" class="lnk">http://codebeautify.org</a></span>
    (<a href="httpcodebeautify.org_jsviewer/Best Online JavaScript Tool to View,Beautify,Formatter,Minify,Obfuscator Javascript Code.html" target="_blank" title="(Will be open in new window.)">Offline.</a>)
    <br>
    <textarea id="raw" style="width: 75%; height: 200px"></textarea>
    <br>

    <label for="">Indent (spaces):</label>
    <input type="number" id="indent" name="tabs" value="2" min="2" style="width: 40px;"></input>

    <button onclick="oneSpaceToFour()" title="Replace one space to several at the line begin.">'&nbsp;' &rarr; '&nbsp;&nbsp;&nbsp;&nbsp;'</button></button>
    <button onclick="process()">Process</button>

    <pre class="prettyprint" id="result"></pre>

    <script>
        function process() {
            // http://stackoverflow.com/questions/15983894/dynamic-google-code-prettify-doesnt-work
            document.getElementById('result').className = 'prettyprint';

            document.getElementById('result').innerText = document.getElementById('raw').value;

            prettyPrint();
        }

        function oneSpaceToFour() {
            var re = /(\n|\r\n)( +)/gm;
            
            var raw = document.getElementById('raw')
            var origin = raw.value;

            var replaceTo = '$1$2';
            var replaceCount = parseInt(document.getElementById('indent').value);
            for (var i = 1; i < replaceCount; i++) {
                replaceTo += '$2';
            }

            origin = origin.replace(re, replaceTo);

            raw.value = origin;
            raw.select();
        }
    </script>
</body>
</html>
